<link rel="import" href="/bower_components/polymer/polymer-element.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">

<dom-module id="sapo-selector">

  <template>

    <style>

      paper-dropdown-menu {
        width: 200px;
      }
      
    </style>

    <paper-dropdown-menu id="contentSelector" label="[[label]]" disabled="[[_isDisabled(data, disabled)]]"
                         no-animations="[[noFun]]" no-label-float="[[noFun]]" noink="[[noFun]]">
      <paper-listbox slot="dropdown-content" selected="{{selected}}" attr-for-selected="value" class="dropdown-content">
        <template is="dom-repeat" items="[[data]]">
          <paper-item value="[[item.identity]]">[[item.text]]</paper-item>
        </template>
      </paper-listbox>
    </paper-dropdown-menu>

  </template>

  <script>
    class SapoSelector extends Polymer.Element {

      static get is() { return 'sapo-selector'; }

      static get properties() {
        return {
          label: String,
          data: {
            type: Array,
            observer: '_dataChanged'
          },
          selected: {
            type: Number,
            notify: true,
            observer: '_selectedChanged'
          },
          disabled: Boolean,
          noFun: Boolean
        }
      }

      _isDisabled(data, disabled) {
        return data.length === 0 || disabled;
      }

      _dataChanged(newData) {
        this.selected = 0;
      }

      _selectedChanged(newValue) {
        this.dispatchEvent(new CustomEvent('select', {detail: {id: this.selected}}));
      }

    }

    window.customElements.define(SapoSelector.is, SapoSelector);
  </script>
</dom-module>
